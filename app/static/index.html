<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Brain Tumor Classifier</title>
<style>
  body{font-family:system-ui,sans-serif;max-width:720px;margin:24px auto;padding:0 12px}
  .card{border:1px solid #e5e7eb;border-radius:12px;padding:16px}
  .row{display:flex;gap:16px;align-items:flex-start;flex-wrap:wrap}
  .btn{padding:10px 14px;border:1px solid #111;background:#111;color:#fff;border-radius:10px;cursor:pointer}
  #cv{max-width:100%;border:1px dashed #bbb;border-radius:8px}
  .tag{display:inline-block;padding:3px 8px;background:#eef2ff;border:1px solid #c7d2fe;border-radius:999px;font-size:12px}
</style>
</head>
<body>
  <h2>Brain Tumor Classifier</h2>
  <div class="card">
    <div class="row">
      <input id="file" type="file" accept="image/*"/>
      <button class="btn" onclick="doPredict()">Predict</button>
    </div>
    <p id="out">Status: <span class="tag">waiting for image…</span></p>
    <canvas id="cv"></canvas>
  </div>

<script>
const imgEl = new Image();
const cv = document.getElementById('cv');
const ctx = cv.getContext('2d');

function draw(file){
  const reader = new FileReader();
  reader.onload = e => {
    imgEl.onload = () => { cv.width=imgEl.width; cv.height=imgEl.height; ctx.drawImage(imgEl,0,0); };
    imgEl.src = e.target.result;
  };
  reader.readAsDataURL(file);
}

async function doPredict(){
  const f = document.getElementById('file').files[0];
  if(!f){ alert('Choose an image first'); return; }
  const fd = new FormData(); fd.append('file', f);
  const res = await fetch('/predict', {method:'POST', body: fd});
  const js = await res.json();
  const tag = js.has_tumor ? 'YES (possible tumor)' : 'NO (no tumor)';
  document.getElementById('out').innerHTML =
    `Has Tumor: <span class="tag">${tag}</span> — Top: <b>${js.top_class}</b>`;
  draw(f);
}
</script>
</body>
</html>
